<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Redirecting...</title>
    <script>
        /**
         * This 404.html file exists to handle GitHub Pages routing limitations with SPAs.
         *
         * Problem:
         * When hosting a React Single Page Application (SPA) on GitHub Pages,
         * direct access to routes like /victoria or /queensland returns a 404
         * because GitHub Pages doesn't know about our client-side routes.
         *
         * Solution:
         * 1. GitHub Pages serves this 404.html when a route is not found
         * 2. We capture the intended route (everything after /online_trip_explorer)
         * 3. We redirect to the root with a hash (#) containing the intended route
         * 4. The React app (using HashRouter) then handles the route correctly
         */
        // Mark that we're in the middle of a redirect
        sessionStorage.setItem("isRedirecting", "true");

        // Extract the path segment and query parameters
        const url = new URL(window.location.href);
        const segment = url.pathname.replace('/online_trip_explorer', '');
        const searchParams = url.search; // This will include the ?fresh=true if present

        // Store the referrer for potential back-navigation
        if (document.referrer && document.referrer !== location.href) {
            sessionStorage.setItem('referrer', document.referrer);
        }

        // Store the current URL state before redirect
        sessionStorage.setItem('redirectUrl', segment + searchParams);

        // Redirect with the full path and query parameters
        window.location.replace('/online_trip_explorer/#' + segment + searchParams);
    </script>
</head>
<body>
    Redirecting...
</body>
</html>
